# ü¶∏ CodeHero: Aprende L√≥gica de Programaci√≥n

Una aplicaci√≥n gamificada para aprender los fundamentos de la programaci√≥n (bucles, condicionales, funciones) a trav√©s de una aventura espacial.

## üöÄ Tecnolog√≠as

*   **Frontend**: HTML5, CSS3, Vanilla JavaScript (MVC Pattern).
*   **Backend**: Supabase (Auth, Database, RLS, Storage).
*   **Herramientas**: Vite (Build Tool), pnpm (Package Manager).

## üõ†Ô∏è Instalaci√≥n y Configuraci√≥n

Sigue estos pasos para configurar el proyecto desde cero.

### 1. Clonar y Dependencias
```bash
git clone <repo-url>
cd CodeHero
pnpm install
```

### 2. Configurar Supabase Backend
1.  Crea un nuevo proyecto en [Supabase](https://supabase.com).
2.  Ve al **SQL Editor** en tu dashboard de Supabase.
3.  Abre el archivo `supabase/schema.sql` (ubicado en la carpeta `supabase` del proyecto).
4.  Copia y pega todo el contenido en el Editor SQL y ejec√∫talo.
    *   Esto crear√° todas las tablas (`profiles`, `levels`, `worlds`, etc.).
    *   Configurar√° las pol√≠ticas de seguridad (RLS).
    *   Crear√° las funciones de administrador necesarias.

### 3. Variables de Entorno
Crea un archivo `.env` en la ra√≠z del proyecto (basado en `.env.example`):

```bash
VITE_SUPABASE_URL=tu_url_de_supabase
VITE_SUPABASE_ANON_KEY=tu_anon_key_de_supabase
```

### 4. Crear el Primer Administrador
Como la aplicaci√≥n protege las funciones de admin, necesitas crear tu primer usuario manualmente y elevarlo a rango 'admin':

1.  Reg√≠strate en la App (o crea un usuario desde el Auth de Supabase).
2.  Ve a la tabla `public.profiles` en Supabase.
3.  Edita tu usuario y cambia la columna `role` de `user` a `admin`.
4.  ¬°Listo! Ahora puedes acceder a `/admin.html`.

### 5. Ejecutar Proyecto
```bash
pnpm run dev
```

---

## üìÇ Administrador (Admin Panel)
Accede a `/admin.html` para gestionar:
*   **Usuarios**: Crear, Editar, Eliminar (con Auth integrado).
*   **Mundos y Fases**: Organizar el contenido educativo.
*   **Tipos de Nivel**: Gestionar categor√≠as din√°micas (ej: Tutorial, Boss, Bucles).
*   **Contenido Actual**:
    *   **Mundo 1 (Cyberpunk)**: 13 Niveles (Algoritmos, Bucles, Condicionales).
    *   **Mundo 2 (Matrix)**: 5 Niveles (Debugging y Refactorizaci√≥n) - *¬°NUEVO!*
*   **Niveles**: Editor visual de mapas (Drag & Drop) para crear puzzles.
*   **Configuraci√≥n**: Activar/Desactivar registros p√∫blicos.

## üîÑ Actualizaci√≥n (Migraci√≥n)
Si ya tienes el proyecto instalado y quieres aplicar las √∫ltimas mejoras (Nueva tabla `level_types`):

1.  Ve al **SQL Editor** en Supabase.
2.  Ejecuta el siguiente comando para alinear tu DB con la √∫ltima versi√≥n:
    ```sql
    -- Crear Tabla Tipos
    create table if not exists public.level_types (
      id bigint generated by default as identity primary key,
      name text unique not null,
      slug text,
      description text,
      color text default '#ffffff',
      created_at timestamp with time zone default timezone('utc'::text, now())
    );
    -- Habilitar RLS
    alter table public.level_types enable row level security;
    create policy "Level Types are public." on level_types for select using (true);
    create policy "Admins can edit level types." on level_types for all using (
      exists (select 1 from public.profiles where id = auth.uid() and role = 'admin')
    );
    -- Datos iniciales (Completo)
    insert into public.level_types (name, slug, color) values 
        ('Tutorial', 'tutorial', '#10b981'),
        ('B√°sico', 'basic', '#3b82f6'),
        ('Giros', 'turns', '#8b5cf6'),
        ('Bucles', 'loops', '#f59e0b'),
        ('Condicionales', 'conditionals', '#ec4899'),
        ('Portales', 'portals', '#06b6d4'),
        ('Debugging', 'debug', '#ef4444'),
        ('Boss', 'boss', '#ffffff')
    on conflict (name) do nothing;
    ```
    *(O copia el contenido actualizado de `supabase/schema.sql`)*.

## ‚ö†Ô∏è Notas Importantes
*   **Usuario Admin**: La creaci√≥n de usuarios desde el Admin Panel usa la API de Supabase Client. Si los registros p√∫blicos est√°n desactivados en Supabase, aseg√∫rate de tener una sesi√≥n v√°lida o usar la Service Key (si se implementa en backend).
*   **Base de Datos**: El script `schema.sql` es idempotente (usa `if not exists`), pero ten cuidado al ejecutarlo en producci√≥n.
